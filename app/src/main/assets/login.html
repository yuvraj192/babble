<!doctype html>
<html lang="en" xmlns:border-radius="https://www.w3.org/1999/xhtml"
      xmlns:text-align="https://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Babble</title>

    <link rel="stylesheet" href="icons.css">
    <link rel="stylesheet" href="tailwind.css">
    <script src="jquery.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css" />
    <style>
    .body {
  background-image: url("https://cliply.co/wp-content/uploads/2019/08/371908020_CONFETTI_400px.gif");
  background-repeat: repeat;
}
    .center {
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 50%;
}

    .theme-shade-text{
            color: #7d4df9 !important;
        }
        .theme-shade-bg{
            background-color: #7d4df9 !important;
        }
</style>
</head>
<body class="theme-shade-bg">

<section class="text-gray-700 body-font log-sec">
    <div class="container px-5 py-24 mx-auto flex flex-wrap items-center">
        <div p class="lg:w-2/6 md:w-1/2 bg-blue rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0">
            <img src="logo.png" class="center animate__animated animate__tada" style="float:center;height:120px;width:120px;" alt="">
            <h2 align="center" class="text-white text-lg font-medium title-font mb-2 animate__animated animate__pulse"><b>Babble</b></h2>
            <span class="text-xl text-white text-center items-center animate__animated animate__fadeIn mb-10 font-bold">Welcome</span>
            <input class="bg-white rounded focus:outline-none text-base px-4 py-3 mb-4 pno placeholder-gray-600" placeholder="Mobile Number" type="tel" maxlength="10">
            <button onclick="login()" class="theme-shade-text bg-white  border-0 py-2 px-8 focus:outline-none rounded text-center lgbtn">Continue <i class="material-icons text-sm mt-2">arrow_forward</i> </button>

        </div>
    </div>
</section>
<section class="text-gray-700 body-font vf-sec animate__animated animate__fadeIn" style="display:none">
    <div class="container px-5 py-24 mx-auto flex flex-wrap items-center">
        <div p class="lg:w-2/6 md:w-1/2 bg-blue rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0">
            <h2 align="center" class="text-black text-2xl font-medium title-font mb-2 animate__animated animate__fadeIn"><b>Device Verification Required</b></h2>
            <span class="text-xs text-black mb-10 text-center items-center animate__animated animate__fadeInUp">We need to verify this device</span>
            <button onclick="endSetup()//requestOTP();this.innerHTML = 'Verifying...';this.disabled = true;" class="bg-white theme-shade-text border-0 py-2 px-8 focus:outline-none rounded text-center mt-4 vfc-btn">Verify Now </button>
        </div>
    </div>
</section>
<section class="text-gray-700 body-font name-sec animate__animated animate__fadeIn" style="display:none">
    <div class="container px-5 py-24 mx-auto flex flex-wrap items-center">
        <div p class="lg:w-2/6 md:w-1/2 bg-blue rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0">
            <h2 align="center" class="text-black text-3xl font-medium title-font mb-12"><b>What's your name?</b></h2>
            <input class="bg-white rounded focus:outline-none text-base px-4 border-b py-3 mb-4 fname placeholder-gray-600" placeholder="First name" type="text">
            <input class="bg-white rounded focus:outline-none text-base px-4 border-b py-3 mb-4 lname placeholder-gray-600" placeholder="last name" type="text">
            <span class="text-xs text-gray-500 text-center items-center">By tapping 'Sign up', you agree to the <span class="theme-shade-text font-bold">Terms of Service</span> and <span class="theme-shade-text font-bold">Privacy Policy</span> </span>
            <button onclick="signUP()" class="theme-shade-bg text-white  border-0 py-2 px-8 focus:outline-none rounded text-center mt-4">Sign Up </button>

        </div>
    </div>
</section>
<section class="text-gray-700 body-font bd-sec animate__animated animate__fadeIn" style="display:none">
    <div class="container px-5 py-24 mx-auto flex flex-wrap items-center">
        <div p class="lg:w-2/6 md:w-1/2 bg-blue rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0">
            <h2 align="center" class="text-black text-2xl font-medium title-font mb-12"><b>When's your birthday?</b></h2>
            <input class="bg-white rounded focus:outline-none text-base px-4 pl-24 border-b py-3 mb-4 bdate placeholder-gray-600 w-full" type="date" value="2002-09-21">
            <button onclick="requestOTP()" class="theme-shade-bg text-white  border-0 py-2 px-8 focus:outline-none rounded text-center mt-4">Continue </button>

        </div>
    </div>
</section>
<section class="text-gray-700 body-font otp-sec animate__animated animate__fadeIn" style="display:none">
    <div class="container px-5 py-24 mx-auto flex flex-wrap items-center">
        <div p class="lg:w-2/6 md:w-1/2 bg-blue rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0">
            <h2 align="center" class="text-black text-2xl font-medium title-font mb-2"><b>Verify your phonenumber!</b></h2>
            <span class="text-xs text-gray-500 mb-10 text-center items-center">Please enter the <span class="theme-shade-text font-bold">OTP</span> sent to  <span class="theme-shade-text font-bold unum"></span> </span>
            <input id="partitioned" class="bg-white rounded focus:outline-none text-base px-4 border-b py-3 mb-4 otp placeholder-gray-600 w-full" placeholder="One Time Password" type="tel" maxlength="6" />
            <button onclick="verify.performClick($('.otp').val())" class="theme-shade-bg text-white  border-0 py-2 px-8 focus:outline-none rounded text-center mt-4">Continue </button>
        </div>
    </div>
</section>
<section class="text-gray-700 body-font congo-sec animate__animated animate__fadeIn" style="display:none">
    <div class="container px-5 py-24 mx-auto flex flex-wrap items-center">
        <div p class="lg:w-2/6 md:w-1/2 bg-blue rounded-lg p-8 flex flex-col md:ml-auto w-full mt-10 md:mt-0">
            <h2 align="center" class="text-black text-2xl font-medium title-font mb-2 animate__animated animate__fadeIn"><b>Welcome <span class="uname"></span>! </b></h2>
            <span class="text-xs text-black mb-10 text-center items-center animate__animated animate__fadeInUp">Your account has been created <span class="theme-shade-text font-bold">Succesfully</span></span>
            <button onclick="endSetup()" class="theme-shade-bg text-white  border-0 py-2 px-8 focus:outline-none rounded text-center mt-4">Continue </button>
        </div>
    </div>
</section>
    <script>
    var name;
    var phoneNumber;
    var bd;
    var mth;
    var vfctimer;

    function login(){
        phoneNumber = $(".pno").val()
        if(phoneNumber == "")return alert("Please Enter Your Phone Number")

        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                mth = "log"
                try{
                   $(".log-sec").hide()
                   $(".vf-sec").show()
                   reg.save(phoneNumber)
                }catch(e){
                    console.log(e)
                }
            }else if(this.status == 404){
                reg.save(phoneNumber)
                mth = "reg"
                document.querySelector('body').classList.remove('theme-shade-bg')
                $('.log-sec').hide()
                $('.name-sec').show()
                change.backColor()
            }
        };
        xhttp.open("GET", "https://iotine.zapto.org:4600/login/"+phoneNumber, true);
        xhttp.send();
    }

    function signUP(){
        name = $('.fname').val()+" "+$('.lname').val()
        $('.bd-sec').show();
        $('.name-sec').hide()
    }

    function requestOTP(){
        bd = $('.bdate').val()
        get.OTP()
    }

    function showOTPBox(){
        if(mth == "log") {
        vfctimer = setTimeout( () => { vfcFailed() }, 120000 )
            $(".lgbtn").html("Verifying device");
            return
            }else if(mth == "reg"){
        $(".unum").html(phoneNumber)
        $('.otp-sec').show()
        $('.bd-sec').hide()
        }
    }
    function putOTP(code){
        $(".otp").val(code)
    }

    function finishSetup(){
    if(mth == "reg"){
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                $(".otp-sec").hide()
                $(".uname").html(name.split(" ")[0])
                $(".congo-sec").show()
                document.querySelector('body').className += " body"
            }else if(this.status == 404){
                make.toast("There was an error creating your account.Please try again later.")
            }
        };
        xhttp.open("GET", "https://iotine.zapto.org:4600/register/"+phoneNumber+"/"+name+"/"+bd, true);
        xhttp.send();
        }else if(mth == "log"){
            $(".vfc-btn").html("Device Verified <i class='material-icons text-green-400'>check</i> ")
            endSetup()
        }
    }

    function endSetup(){
        valid.performClick(btoa(phoneNumber));
        go.home(phoneNumber)
    }

    function goTohome(pno){
        go.home(atob(pno))
    }

    function vfcFailed(){
        if(mth != "log") return
        $(".vfc-btn").html(" <span class='text-red-500'>Verification Failed</span> ")
        if(typeof vfctimer != "undefined") clearTimeout(vfctimer)
        setTimeout( () => { window.location.reload() }, 2000)
    }
</script>
</body>
</html>